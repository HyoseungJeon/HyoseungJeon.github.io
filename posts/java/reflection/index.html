<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Reflection | HyoSeung IT blog</title><meta name=keywords content="Java,OOP"><meta name=description content="Reflection이란? 정의 Reflection enables Java code to discover information about the fields, methods and constructors of loaded classes, and to use reflected fields, methods, and constructors to operate on their underlying counterparts, within security restrictions. The API accommodates applications that need access to either the public members of a target object (based on its runtime class) or the members declared by a given class. It also allows programs to suppress default reflective access control."><meta name=author content="HyoSeung Jeon"><link rel=canonical href=https://HyoseungJeon.github.io/posts/java/reflection/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://HyoseungJeon.github.io/profile.png><link rel=icon type=image/png sizes=16x16 href=https://HyoseungJeon.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://HyoseungJeon.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://HyoseungJeon.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://HyoseungJeon.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><script defer crossorigin=anonymous src=/js/pro.sidebar.js></script><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Reflection"><meta property="og:description" content="Reflection이란? 정의 Reflection enables Java code to discover information about the fields, methods and constructors of loaded classes, and to use reflected fields, methods, and constructors to operate on their underlying counterparts, within security restrictions. The API accommodates applications that need access to either the public members of a target object (based on its runtime class) or the members declared by a given class. It also allows programs to suppress default reflective access control."><meta property="og:type" content="article"><meta property="og:url" content="https://HyoseungJeon.github.io/posts/java/reflection/"><meta property="og:image" content="https://HyoseungJeon.github.io/profile2.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-21T13:48:03+09:00"><meta property="article:modified_time" content="2023-07-21T13:48:03+09:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://HyoseungJeon.github.io/profile2.png"><meta name=twitter:title content="Reflection"><meta name=twitter:description content="Reflection이란? 정의 Reflection enables Java code to discover information about the fields, methods and constructors of loaded classes, and to use reflected fields, methods, and constructors to operate on their underlying counterparts, within security restrictions. The API accommodates applications that need access to either the public members of a target object (based on its runtime class) or the members declared by a given class. It also allows programs to suppress default reflective access control."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://HyoseungJeon.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Java","item":"https://HyoseungJeon.github.io/posts/java/"},{"@type":"ListItem","position":3,"name":"Reflection","item":"https://HyoseungJeon.github.io/posts/java/reflection/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Reflection","name":"Reflection","description":"Reflection이란? 정의 Reflection enables Java code to discover information about the fields, methods and constructors of loaded classes, and to use reflected fields, methods, and constructors to operate on their underlying counterparts, within security restrictions. The API accommodates applications that need access to either the public members of a target object (based on its runtime class) or the members declared by a given class. It also allows programs to suppress default reflective access control.","keywords":["Java","OOP"],"articleBody":" Reflection이란? 정의 Reflection enables Java code to discover information about the fields, methods and constructors of loaded classes, and to use reflected fields, methods, and constructors to operate on their underlying counterparts, within security restrictions. The API accommodates applications that need access to either the public members of a target object (based on its runtime class) or the members declared by a given class. It also allows programs to suppress default reflective access control. - Oracle Java Doc\n나만의 정의로는 Runtime 환경에 들어서 load된 Class의 각 속성에 접근할 수 있는 기능이다.\nComplie 환경이 아닌 곳에서 정의되지 않은 Class에 접근하여 constructor, method, field, annotation 을 조작, 사용할 수 있다.\n생각해볼 점 우리는 Java를 객체지향언어(OOP) 라고 학습했었다. 지겹도록 들은 OOP의 특장점으로 캡슐화를 논하였는데 Reflection은 캡슐화를 위반하는 성격을 갖고 있다.\n왜 OOP 언어가 자신의 특징을 위반하는 API spec을 갖고 있을까?\n난 이점이 재밌다고 본다. 그리고 이 Spec 현재에 많은 것들을 가능하게 만들었다!\n결국 정체성과 별개로 Java는 객체의 활용성에 집중을 했다고 개인적으로 생각한다. 간단하게 이 기술을 살펴보면서 생각을 더 넓혀보자!!\n사용 방법 Simple case public static void main(String[] args) { Object obj = new Object(); try { Class cls = obj.getClass(); Constructor[] constructors = cls.getConstructors(); Method[] methods = cls.getMethods(); Field[] fields = cls.getFields(); Arrays.stream(fields).forEach(field -\u003e { Annotation[] annotations = field.getAnnotations(); if (field.isAnnotationPresent(Service.class)) { return; } }); } catch (Exception e) { System.out.println(e); } } 위의 간단한 예제와 같이 객체에서 Class 를 추출 후 해당 속성인 값들을 꺼낼 수 있다.\n이후 각 속성 값들의 cotroll methods 이나 세부 방법은 다른 blog나 문서들을 참고 하는 것이 좋을 것 같다.\n내 사용 예제 프로젝트를 진행하면서 공통으로 Masking 기능을 구현할 일이 생겼다. 프로젝트 내에 따로 Common Soruce가 존재하지 않아 직접 구현해야 하는 상황 이였다.\npublic class MaskingUtil { /** * Dto class 마스킹 처리 * * @param dto * @return 성공여부 */ public static void maskingDto(Object dto) { Field[] fields = dto.getClass().getDeclaredFields(); if (List.class.isInstance(dto)) { List\u003c?\u003e listDto = (List\u003c?\u003e) dto; listDto.forEach(MaskingUtil::maskingDto); } else { for (Field field : fields) { if (!field.isAnnotationPresent(Masking.class) || !field.getType().equals(String.class)) continue; maskingField(field, dto); } } } private static void maskingField(Field field, Object dto) { Masking annotation = field.getAnnotation(Masking.class); field.setAccessible(true); try { field.set(dto, maskingString(MaskingType.valueOf(annotation.type().name()), String.valueOf(field.get(dto)))); } catch (IllegalAccessException e) { throw new RuntimeException(e); } finally { field.setAccessible(false); } } private static String maskingString(MaskingType maskingType, String str) { String result = \"\"; MaskingEntity maskingEntity = MaskingType.map.get(maskingType.name()); if(\"null\".equals(str)) return result; if(Objects.nonNull(maskingEntity) \u0026\u0026 StringUtils.hasText(maskingEntity.getRegex())) { result = str.replaceAll(maskingEntity.getRegex(), maskingEntity.getReplacement()); } else { switch (maskingType) { case NAME: { if (str.length() \u003e 2) result = str.replaceAll(\"(?\u003c=.{1,2}).(?=.{1,2})\", maskingEntity.getReplacement()); else result = str.replaceAll(\"(?\u003c=.{1,2}).(?=.{0,2})\", maskingEntity.getReplacement()); break; } case ADDRESS_BASE: { StringJoiner sj = new StringJoiner(\" \"); String[] splitStr = str.split(\"\\\\\\\\s\"); if (splitStr.length \u003e 2) { sj.add(splitStr[0]).add(splitStr[1].replaceAll(\"(?\u003c=.).\", \"*\")); Arrays.stream(splitStr).skip(2).forEach(el -\u003e { sj.add(el.replaceAll(\".\", \"*\")); }); } else { result = str; } break; } } } return result; } Process를 간단히 요약하면\nObject를 1개 받아 Field값들을 읽는다. Masking Annotation(Custom Annotation) 존재 여부 확인 후 Masking 처리를 시도한다. 따로 정의한 MaskingType enum class 을 참조하여 regex pattern을 받아 replaceAll 처리한다. 단, 정의된 pattern이 없을 시 Case에 따라 따로 Masking 처리를 한다. 세세한 내용들은 source 단을 확인한다.\n추가적으로 https://github.com/HyoseungJeon/JPA 에 내용이 작성되어있으니 참고한다.\n실제로 완벽한 source는 아니다. Collection Type을 List만 처리해 놓은 부분과 내부 Field 내의 Collection 처리 부분 custom Masking 처리 부분의 분리 등등 정리하지 못한 내용이 많다. 차차 내 나름대로의 version Update가 필요해 보인다..\n하지만 내가 집중하고 싶은 부분은 위 방법을 통해서 Masking 과정이 굉장히 간편해졌다.\n실제 response에 담을 Dto 객체에 Masking이 필요한 Field위에 annotation을 입력 후, method에 넘기기만 한다면 Masking 처리가 된다. 프로젝트 내에서는 문제 없이 잘 활용하였다. 위 code를 작성한 프로젝트 이전에는 이미 만들어져 있는 Masking Framwork을 따라 쉽게 작성하여 내부 logic을 파악하지 못하여 내 주관대로 작성한 부분이 있어 아쉽지만 위와 같은 과정을 거쳤을 거라고 생각한다.\nReflectionUtils Spring에서 제공하는 Reflection API를 활용하기 위한 interface Util class를 발견했다!새로 투입된 프로젝트 내의 Masking Source를 탐험하던 중 해당 Lib를 보게 되었다…!😍\n기존 Reflection을 raw 방식으로 활용할 때에는 Exception 처리나 내가 예상하지 못하는 error 들을 발견하거나 방지하기가 어려웠다.. 😢 근데 해당 Lib 내용을 살펴보니 발견하지 못했던 issue들을 처리한 code를 볼 수 있었다! Spring이 Reflection을 활용하다 보니 당연하게도 안정적으로 제공하는 Util이 있을 것인데.. 생각을 못해봤던 것 같다..! 구글링도 좋지만 확실히 source 단에서도 관련 lib을 검색해보는 것도 필요한 것 같다!\npublic static void doWithFields(Class\u003c?\u003e clazz, FieldCallback fc, @Nullable FieldFilter ff) { Class\u003c?\u003e targetClass = clazz; do { Field[] fields = getDeclaredFields(targetClass); Field[] var5 = fields; int var6 = fields.length; for(int var7 = 0; var7 \u003c var6; ++var7) { Field field = var5[var7]; if (ff == null || ff.matches(field)) { try { fc.doWith(field); } catch (IllegalAccessException var10) { throw new IllegalStateException(\"Not allowed to access field '\" + field.getName() + \"': \" + var10); } } } targetClass = targetClass.getSuperclass(); } while(targetClass != null \u0026\u0026 targetClass != Object.class); } 특히 fields들을 조회하는 method를 보면 targetClass = targetClass.getSuperclass(); 부분이 있다! extend하는 경우는 생각하지 못했었는데.. 이러한 처리 부분이 있는 걸 보고 좀 쇼킹했다!\n내 생각 장점 정확히 정의된 Class를 입력 받는 것이 아닌, 추상화 상태의 Class를 통해 조작을 하니 넓은 범위를 커버 가능한 method를 작성할 수 있다는 게 큰 장점인 것 같다. 실제로 Spring이 구현될 수 있었던 핵심 spec 아닐까..?\n단점 OOP의 원칙인 캡슐화를 부숴버린다!! 생각보다 심각한 문제라고 생각이 들긴 하는데 만약 해당 method가 정확하게 guide 된 것에 따라가지 않는다면 사용자는 확인하기 어려운 이슈가 발생할 수 있을 것 같다!\n또한 연관 검색어로 항상 성능 이슈가 나온다! 그 원인은 Compiler의 최적화 단계를 거치지 않기 때문이라고 한다. 해서 무거운 logic이나 무분별하게 도입하는 거는 지양해야 할 것 같다.\nhttps://lob-dev.tistory.com/entry/Java의-Reflection-API\n정리 Relection은 내 눈에는 보이지 않지만 수많은 Lib 내에서 나의 개발을 유연하게 돕는 역할로 매우 많이 쓰이는 API 이다. 그 기능을 이용하여 실제로 개발을 해보니 정말로 강력한 기능이라는 느낌이 들었다. 항상 Java 개발을 하면서 “아 이런 부분은 field로 조작해서 할 수 있지 않을까?” 라고 생각해 왔던 것들을 프로젝트 내에서 실제로 구현해보고, 해당 방식을 통하여 기존의 source의 길이가 어마어마하게 줄어들고, 유지보수도 매우 쉬어지는 것을 경험했다.\n단순히 내가 구현을 해보며 느낀 장점 뿐만 아니라 실제로 프로젝트에 사용되는 주요 FrameWork들의 구현 방법에 대하여 알게 되어 조금 더 FrameWork의 구조를 파악하고 또 debugging 할 수 있는 영역이 늘어난 점도 매우 좋은 것 같다. 더욱 넓은 시각을 통해서 단순히 낮은 soruce level이 아닌 구조 전체를 통해서 문제를 파악하는 능력이 큰 것 같다!\n항상 생각하는 거지만, 그냥 편의를 누리는 것은 개발자에게 가장 치명적인 독인 것 같다.. 그냥 납득하지 말자!\n참조:\nhttps://docs.oracle.com/javase/8/docs/technotes/guides/reflection/index.html\nhttps://lob-dev.tistory.com/entry/Java의-Reflection-API\nhttps://gyrfalcon.tistory.com/entry/Java-Reflection\n","wordCount":"1021","inLanguage":"en","datePublished":"2023-07-21T13:48:03+09:00","dateModified":"2023-07-21T13:48:03+09:00","author":{"@type":"Person","name":"HyoSeung Jeon"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://HyoseungJeon.github.io/posts/java/reflection/"},"publisher":{"@type":"Organization","name":"HyoSeung IT blog","logo":{"@type":"ImageObject","url":"https://HyoseungJeon.github.io/profile.png"}}}</script><link rel=stylesheet href=https://HyoseungJeon.github.io/scss/main.css></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://HyoseungJeon.github.io/ accesskey=h title="Home (Alt + H)"><img src=https://HyoseungJeon.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://HyoseungJeon.github.io/posts/ title=posts class=btn-12><span style=font-family:SUITE-Regular;font-size:19px>posts</span></a></li><li><a href=https://HyoseungJeon.github.io/tags/ title=tags class=btn-12><span style=font-family:SUITE-Regular;font-size:19px>tags</span></a></li><li><a href=https://HyoseungJeon.github.io/archives/ title=archives class=btn-12><span style=font-family:SUITE-Regular;font-size:19px>archives</span></a></li><li><a href=https://HyoseungJeon.github.io/search/ title="search (Alt + /)" class=btn-12 accesskey=/><span style=font-family:SUITE-Regular;font-size:19px>search</span></a></li></ul></nav></header><main class="main page"><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://HyoseungJeon.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://HyoseungJeon.github.io/posts/>Posts</a>&nbsp;»&nbsp;<a href=https://HyoseungJeon.github.io/posts/java/>Java</a></div><h1 class=post-title>Reflection</h1><div class=post-meta><span title='2023-07-21 13:48:03 +0900 +0900'>July 21, 2023</span>&nbsp;·&nbsp;1021 words&nbsp;·&nbsp;HyoSeung Jeon</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner style=padding-top:10px><ul><li><a href=#reflection%ec%9d%b4%eb%9e%80 aria-label=Reflection이란?>Reflection이란?</a><ul><li><a href=#%ec%a0%95%ec%9d%98 aria-label=정의>정의</a></li><li><a href=#%ec%83%9d%ea%b0%81%ed%95%b4%eb%b3%bc-%ec%a0%90 aria-label="생각해볼 점">생각해볼 점</a></li></ul></li><li><a href=#%ec%82%ac%ec%9a%a9-%eb%b0%a9%eb%b2%95 aria-label="사용 방법">사용 방법</a><ul><li><a href=#simple-case aria-label="Simple case">Simple case</a></li><li><a href=#%eb%82%b4-%ec%82%ac%ec%9a%a9-%ec%98%88%ec%a0%9c aria-label="내 사용 예제">내 사용 예제</a></li><li><a href=#reflectionutils aria-label=ReflectionUtils>ReflectionUtils</a></li></ul></li><li><a href=#%eb%82%b4-%ec%83%9d%ea%b0%81 aria-label="내 생각">내 생각</a><ul><li><a href=#%ec%9e%a5%ec%a0%90 aria-label=장점>장점</a></li><li><a href=#%eb%8b%a8%ec%a0%90 aria-label=단점>단점</a></li><li><a href=#%ec%a0%95%eb%a6%ac aria-label=정리>정리</a></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?(document.getElementById("toc-container").classList.add("wide"),document.getElementById("menu-container").style.display=""):(document.getElementById("toc-container").classList.remove("wide"),document.getElementById("menu-container").style.display="none")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/remixicon@2.2.0/fonts/remixicon.css><link rel=stylesheet href=https://unpkg.com/css-pro-layout@1.1.0/dist/css/css-pro-layout.css><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&amp;display=swap"><script src=https://unpkg.com/@popperjs/core@2></script><div id=menu-container class="layout toc-container wide-r"><aside id=sidebar class="sidebar break-point-sm has-bg-image" style=width:100%;position:sticky;top:var(--gap)><div class=sidebar-layout><div class=sidebar-content><nav class="menu open-current-submenu"><ul><li class="menu-item sub-menu"><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>API
<span class=menu-title-suffix>(4)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class=menu-item><a href=/posts/api/fcm/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>FCM</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/api/nice%EB%B3%B8%EC%9D%B8%EC%9D%B8%EC%A6%9D/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Nice 본인인증</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/api/nice%EB%B3%B8%EC%9D%B8%EC%9D%B8%EC%A6%9D%EC%9D%B4%EC%8A%88%EB%8C%80%EC%9D%91/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Nice본인인증 이슈대응</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/api/nice%EB%B3%B8%EC%9D%B8%EC%9D%B8%EC%A6%9D%EC%9D%B4%EC%8A%88%EB%8C%80%EC%9D%912/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Nice본인인증이슈대응2</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu"><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Chrome
<span class=menu-title-suffix>(1)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class=menu-item><a href=/posts/chrome/debug/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Debug</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu"><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Design Patterns
<span class=menu-title-suffix>(3)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class="menu-item sub-menu"><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Behavioral Patterns
<span class=menu-title-suffix>(1)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class=menu-item><a href=/posts/designpattern/behavioral-patterns/strategypattern/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Strategy Pattern</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class=menu-item><a href=/posts/designpattern/creational-patterns/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Creational Patterns</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/designpattern/structural-patterns/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Structural Patterns</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu"><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>ETC
<span class=menu-title-suffix>(3)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class=menu-item><a href=/posts/etc/msaidauditing/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>MSA Id Auditing</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/etc/msa-%ED%99%98%EA%B2%BD-traceid-logging/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>MSA 환경 TraceId Logging</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/etc/oauth/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>OAuth</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu"><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>HTML
<span class=menu-title-suffix>(2)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class=menu-item><a href=/posts/html/pagereloadissue/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Page Reload Issue</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/html/pagereloadissue2/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Page Reload Issue 2</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu"><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Intellij
<span class=menu-title-suffix>(2)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class=menu-item><a href=/posts/intellij/propertiesautoupper/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Properties Auto Upper</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/intellij/thymeleaf/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Thymeleaf</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu"><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Java
<span class=menu-title-suffix>(8)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class=menu-item><a href=/posts/java/blockingqueue/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Blocking Queue</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/java/cursor/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Cursor</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/java/file/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>File</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/java/function-package/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Function Package</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/java/future/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Future</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/java/generic/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Generic</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/java/reflection/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Reflection</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/java/synchronized/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Synchronized</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu"><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Java Script
<span class=menu-title-suffix>(2)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class=menu-item><a href=/posts/javascript/validate/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Custom Validate</span>
<span class=menu-suffix></span></a></li><li class="menu-item sub-menu"><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Date
<span class=menu-title-suffix>(1)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class=menu-item><a href=/posts/javascript/date/setdate/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>setDate</span>
<span class=menu-suffix></span></a></li></ul></div></li></ul></div></li><li class="menu-item sub-menu"><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>JQuery
<span class=menu-title-suffix>(2)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class=menu-item><a href=/posts/jquery/validate/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>JQuery Validate</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/jquery/ztree/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>ZTree</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu"><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Spring
<span class=menu-title-suffix>(5)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class=menu-item><a href=/posts/spring/async/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Async</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/spring/cache/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Cache</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/spring/requestcontextholder/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>RequestContextHolder</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/spring/scope/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Scope</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/spring/springsecurity/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Spring Security</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu"><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>SQL
<span class=menu-title-suffix>(1)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class=menu-item><a href=/posts/sql/withrecursive/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>With Recursive</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu"><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Window
<span class=menu-title-suffix>(1)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class=menu-item><a href=/posts/window/nud%EB%A9%94%EB%AA%A8%EB%A6%AC%EB%88%84%EC%88%98/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Nud 메모리누수</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu"><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>독후감
<span class=menu-title-suffix>(2)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class=menu-item><a href=/posts/%EB%8F%85%ED%9B%84%EA%B0%90/cleanarchitecture/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Clean Architecture</span>
<span class=menu-suffix></span></a></li><li class=menu-item><a href=/posts/%EB%8F%85%ED%9B%84%EA%B0%90/%ED%95%A8%EC%88%98%ED%98%95%EC%BD%94%EB%94%A9/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>쏙쏙 들어오는 함수형 코딩</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu"><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>일기장
<span class=menu-title-suffix>(1)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class=menu-item><a href=/posts/%EC%9D%BC%EA%B8%B0%EC%9E%A5/23-07-18/><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>23.07.18</span>
<span class=menu-suffix></span></a></li></ul></div></li><ul></nav></div></div><div class=sidebar-footer></div></aside></div><style scoped></style><link rel=stylesheet href=https://HyoseungJeon.github.io/scss/pro-sidebar.css><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition()},!1),window.addEventListener("resize",function(){checkTocPosition()},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("menu-container").style.display="":document.getElementById("menu-container").style.display="none"}</script><div class=post-content><hr><h2 id=reflection이란>Reflection이란?<a hidden class=anchor aria-hidden=true href=#reflection이란>#</a></h2><h3 id=정의>정의<a hidden class=anchor aria-hidden=true href=#정의>#</a></h3><blockquote><p>Reflection enables Java code to discover information about the fields, methods and constructors of loaded classes, and to use reflected fields, methods, and constructors to operate on their underlying counterparts, within security restrictions. The API accommodates applications that need access to either the public members of a target object (based on its runtime class) or the members declared by a given class. It also allows programs to suppress default reflective access control. - Oracle Java Doc</p></blockquote><p>나만의 정의로는 Runtime 환경에 들어서 load된 Class의 각 속성에 접근할 수 있는 기능이다.</p><p>Complie 환경이 아닌 곳에서 정의되지 않은 Class에 접근하여 constructor, method, field, annotation 을 조작, 사용할 수 있다.</p><h3 id=생각해볼-점>생각해볼 점<a hidden class=anchor aria-hidden=true href=#생각해볼-점>#</a></h3><p>우리는 Java를 객체지향언어(OOP) 라고 학습했었다. 지겹도록 들은 OOP의 특장점으로 캡슐화를 논하였는데 <strong>Reflection은 캡슐화를 위반</strong>하는 성격을 갖고 있다.</p><p>왜 OOP 언어가 자신의 특징을 위반하는 API spec을 갖고 있을까?</p><p>난 이점이 재밌다고 본다. 그리고 이 Spec 현재에 많은 것들을 가능하게 만들었다!</p><p>결국 정체성과 별개로 Java는 <strong>객체의 활용성에 집중</strong>을 했다고 개인적으로 생각한다. 간단하게 이 기술을 살펴보면서 생각을 더 넓혀보자!!</p><h2 id=사용-방법>사용 방법<a hidden class=anchor aria-hidden=true href=#사용-방법>#</a></h2><h3 id=simple-case>Simple case<a hidden class=anchor aria-hidden=true href=#simple-case>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>		<span class=n>Object</span> <span class=n>obj</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Object</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>			<span class=n>Class</span> <span class=n>cls</span> <span class=o>=</span> <span class=n>obj</span><span class=o>.</span><span class=na>getClass</span><span class=o>();</span>
</span></span><span class=line><span class=cl>			<span class=n>Constructor</span><span class=o>[]</span> <span class=n>constructors</span> <span class=o>=</span> <span class=n>cls</span><span class=o>.</span><span class=na>getConstructors</span><span class=o>();</span>
</span></span><span class=line><span class=cl>			<span class=n>Method</span><span class=o>[]</span> <span class=n>methods</span> <span class=o>=</span> <span class=n>cls</span><span class=o>.</span><span class=na>getMethods</span><span class=o>();</span>
</span></span><span class=line><span class=cl>			<span class=n>Field</span><span class=o>[]</span> <span class=n>fields</span> <span class=o>=</span> <span class=n>cls</span><span class=o>.</span><span class=na>getFields</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=n>Arrays</span><span class=o>.</span><span class=na>stream</span><span class=o>(</span><span class=n>fields</span><span class=o>).</span><span class=na>forEach</span><span class=o>(</span><span class=n>field</span> <span class=o>-&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>				<span class=n>Annotation</span><span class=o>[]</span> <span class=n>annotations</span> <span class=o>=</span> <span class=n>field</span><span class=o>.</span><span class=na>getAnnotations</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>				<span class=k>if</span> <span class=o>(</span><span class=n>field</span><span class=o>.</span><span class=na>isAnnotationPresent</span><span class=o>(</span><span class=n>Service</span><span class=o>.</span><span class=na>class</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>					<span class=k>return</span><span class=o>;</span>
</span></span><span class=line><span class=cl>				<span class=o>}</span>
</span></span><span class=line><span class=cl>			<span class=o>});</span>
</span></span><span class=line><span class=cl>		<span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>Exception</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>			<span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>		<span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>위의 간단한 예제와 같이 객체에서 <code>Class</code> 를 추출 후 해당 속성인 값들을 꺼낼 수 있다.</p><p>이후 각 속성 값들의 cotroll methods 이나 세부 방법은 다른 blog나 문서들을 참고 하는 것이 좋을 것 같다.</p><h3 id=내-사용-예제>내 사용 예제<a hidden class=anchor aria-hidden=true href=#내-사용-예제>#</a></h3><p>프로젝트를 진행하면서 공통으로 Masking 기능을 구현할 일이 생겼다. 프로젝트 내에 따로 Common Soruce가 존재하지 않아 직접 구현해야 하는 상황 이였다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MaskingUtil</span> <span class=o>{</span>
</span></span><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * Dto class 마스킹 처리
</span></span></span><span class=line><span class=cl><span class=cm> *
</span></span></span><span class=line><span class=cl><span class=cm> * @param dto
</span></span></span><span class=line><span class=cl><span class=cm> * @return 성공여부
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>maskingDto</span><span class=o>(</span><span class=n>Object</span> <span class=n>dto</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Field</span><span class=o>[]</span> <span class=n>fields</span> <span class=o>=</span> <span class=n>dto</span><span class=o>.</span><span class=na>getClass</span><span class=o>().</span><span class=na>getDeclaredFields</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>List</span><span class=o>.</span><span class=na>class</span><span class=o>.</span><span class=na>isInstance</span><span class=o>(</span><span class=n>dto</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>List</span><span class=o>&lt;?&gt;</span> <span class=n>listDto</span> <span class=o>=</span> <span class=o>(</span><span class=n>List</span><span class=o>&lt;?&gt;)</span> <span class=n>dto</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>listDto</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>MaskingUtil</span><span class=o>::</span><span class=n>maskingDto</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=o>(</span><span class=n>Field</span> <span class=n>field</span> <span class=o>:</span> <span class=n>fields</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>(!</span><span class=n>field</span><span class=o>.</span><span class=na>isAnnotationPresent</span><span class=o>(</span><span class=n>Masking</span><span class=o>.</span><span class=na>class</span><span class=o>)</span> <span class=o>||</span> <span class=o>!</span><span class=n>field</span><span class=o>.</span><span class=na>getType</span><span class=o>().</span><span class=na>equals</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=na>class</span><span class=o>))</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=n>maskingField</span><span class=o>(</span><span class=n>field</span><span class=o>,</span> <span class=n>dto</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>private</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>maskingField</span><span class=o>(</span><span class=n>Field</span> <span class=n>field</span><span class=o>,</span> <span class=n>Object</span> <span class=n>dto</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Masking</span> <span class=n>annotation</span> <span class=o>=</span> <span class=n>field</span><span class=o>.</span><span class=na>getAnnotation</span><span class=o>(</span><span class=n>Masking</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>field</span><span class=o>.</span><span class=na>setAccessible</span><span class=o>(</span><span class=kc>true</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>field</span><span class=o>.</span><span class=na>set</span><span class=o>(</span><span class=n>dto</span><span class=o>,</span> <span class=n>maskingString</span><span class=o>(</span><span class=n>MaskingType</span><span class=o>.</span><span class=na>valueOf</span><span class=o>(</span><span class=n>annotation</span><span class=o>.</span><span class=na>type</span><span class=o>().</span><span class=na>name</span><span class=o>()),</span> <span class=n>String</span><span class=o>.</span><span class=na>valueOf</span><span class=o>(</span><span class=n>field</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>dto</span><span class=o>))));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>IllegalAccessException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=k>finally</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>field</span><span class=o>.</span><span class=na>setAccessible</span><span class=o>(</span><span class=kc>false</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>private</span> <span class=kd>static</span> <span class=n>String</span> <span class=nf>maskingString</span><span class=o>(</span><span class=n>MaskingType</span> <span class=n>maskingType</span><span class=o>,</span> <span class=n>String</span> <span class=n>str</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>MaskingEntity</span> <span class=n>maskingEntity</span> <span class=o>=</span> <span class=n>MaskingType</span><span class=o>.</span><span class=na>map</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>maskingType</span><span class=o>.</span><span class=na>name</span><span class=o>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=o>(</span><span class=s>&#34;null&#34;</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=n>str</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=o>(</span><span class=n>Objects</span><span class=o>.</span><span class=na>nonNull</span><span class=o>(</span><span class=n>maskingEntity</span><span class=o>)</span> <span class=o>&amp;&amp;</span> <span class=n>StringUtils</span><span class=o>.</span><span class=na>hasText</span><span class=o>(</span><span class=n>maskingEntity</span><span class=o>.</span><span class=na>getRegex</span><span class=o>()))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>str</span><span class=o>.</span><span class=na>replaceAll</span><span class=o>(</span><span class=n>maskingEntity</span><span class=o>.</span><span class=na>getRegex</span><span class=o>(),</span> <span class=n>maskingEntity</span><span class=o>.</span><span class=na>getReplacement</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span> <span class=o>(</span><span class=n>maskingType</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=n>NAME</span><span class=o>:</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=o>(</span><span class=n>str</span><span class=o>.</span><span class=na>length</span><span class=o>()</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>result</span> <span class=o>=</span> <span class=n>str</span><span class=o>.</span><span class=na>replaceAll</span><span class=o>(</span><span class=s>&#34;(?&lt;=.{1,2}).(?=.{1,2})&#34;</span><span class=o>,</span> <span class=n>maskingEntity</span><span class=o>.</span><span class=na>getReplacement</span><span class=o>());</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span>
</span></span><span class=line><span class=cl>                    <span class=n>result</span> <span class=o>=</span> <span class=n>str</span><span class=o>.</span><span class=na>replaceAll</span><span class=o>(</span><span class=s>&#34;(?&lt;=.{1,2}).(?=.{0,2})&#34;</span><span class=o>,</span> <span class=n>maskingEntity</span><span class=o>.</span><span class=na>getReplacement</span><span class=o>());</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=n>ADDRESS_BASE</span><span class=o>:</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>StringJoiner</span> <span class=n>sj</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StringJoiner</span><span class=o>(</span><span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                <span class=n>String</span><span class=o>[]</span> <span class=n>splitStr</span> <span class=o>=</span> <span class=n>str</span><span class=o>.</span><span class=na>split</span><span class=o>(</span><span class=s>&#34;\\\\s&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=o>(</span><span class=n>splitStr</span><span class=o>.</span><span class=na>length</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>sj</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>splitStr</span><span class=o>[</span><span class=mi>0</span><span class=o>]).</span><span class=na>add</span><span class=o>(</span><span class=n>splitStr</span><span class=o>[</span><span class=mi>1</span><span class=o>].</span><span class=na>replaceAll</span><span class=o>(</span><span class=s>&#34;(?&lt;=.).&#34;</span><span class=o>,</span> <span class=s>&#34;*&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>                    <span class=n>Arrays</span><span class=o>.</span><span class=na>stream</span><span class=o>(</span><span class=n>splitStr</span><span class=o>).</span><span class=na>skip</span><span class=o>(</span><span class=mi>2</span><span class=o>).</span><span class=na>forEach</span><span class=o>(</span><span class=n>el</span> <span class=o>-&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>sj</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>el</span><span class=o>.</span><span class=na>replaceAll</span><span class=o>(</span><span class=s>&#34;.&#34;</span><span class=o>,</span> <span class=s>&#34;*&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>                    <span class=o>});</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>result</span> <span class=o>=</span> <span class=n>str</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Process를 간단히 요약하면</p><ol><li>Object를 1개 받아 Field값들을 읽는다.</li><li><code>Masking Annotation(Custom Annotation)</code> 존재 여부 확인 후 Masking 처리를 시도한다.</li><li>따로 정의한 <code>MaskingType enum class</code> 을 참조하여 regex pattern을 받아 <code>replaceAll</code> 처리한다.<ol><li>단, 정의된 pattern이 없을 시 Case에 따라 따로 Masking 처리를 한다.</li></ol></li></ol><p>세세한 내용들은 source 단을 확인한다.</p><p>추가적으로 <a href=https://github.com/HyoseungJeon/JPA>https://github.com/HyoseungJeon/JPA</a> 에 내용이 작성되어있으니 참고한다.</p><p>실제로 완벽한 source는 아니다. Collection Type을 List만 처리해 놓은 부분과 내부 Field 내의 Collection 처리 부분 custom Masking 처리 부분의 분리 등등 정리하지 못한 내용이 많다. 차차 내 나름대로의 version Update가 필요해 보인다..</p><p>하지만 내가 집중하고 싶은 부분은 위 방법을 통해서 Masking 과정이 굉장히 간편해졌다.</p><p>실제 response에 담을 Dto 객체에 Masking이 필요한 Field위에 annotation을 입력 후, method에 넘기기만 한다면 Masking 처리가 된다. 프로젝트 내에서는 문제 없이 잘 활용하였다. 위 code를 작성한 프로젝트 이전에는 이미 만들어져 있는 Masking Framwork을 따라 쉽게 작성하여 내부 logic을 파악하지 못하여 내 주관대로 작성한 부분이 있어 아쉽지만 위와 같은 과정을 거쳤을 거라고 생각한다.</p><h3 id=reflectionutils>ReflectionUtils<a hidden class=anchor aria-hidden=true href=#reflectionutils>#</a></h3><p>Spring에서 제공하는 Reflection API를 활용하기 위한 interface Util class를 발견했다!새로 투입된 프로젝트 내의 Masking Source를 탐험하던 중 해당 Lib를 보게 되었다…!😍</p><p>기존 Reflection을 raw 방식으로 활용할 때에는 Exception 처리나 내가 예상하지 못하는 error 들을 발견하거나 방지하기가 어려웠다.. 😢 근데 해당 Lib 내용을 살펴보니 발견하지 못했던 issue들을 처리한 code를 볼 수 있었다! Spring이 Reflection을 활용하다 보니 당연하게도 안정적으로 제공하는 Util이 있을 것인데.. 생각을 못해봤던 것 같다..! 구글링도 좋지만 확실히 source 단에서도 관련 lib을 검색해보는 것도 필요한 것 같다!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>doWithFields</span><span class=o>(</span><span class=n>Class</span><span class=o>&lt;?&gt;</span> <span class=n>clazz</span><span class=o>,</span> <span class=n>FieldCallback</span> <span class=n>fc</span><span class=o>,</span> <span class=nd>@Nullable</span> <span class=n>FieldFilter</span> <span class=n>ff</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Class</span><span class=o>&lt;?&gt;</span> <span class=n>targetClass</span> <span class=o>=</span> <span class=n>clazz</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>do</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Field</span><span class=o>[]</span> <span class=n>fields</span> <span class=o>=</span> <span class=n>getDeclaredFields</span><span class=o>(</span><span class=n>targetClass</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>Field</span><span class=o>[]</span> <span class=n>var5</span> <span class=o>=</span> <span class=n>fields</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>var6</span> <span class=o>=</span> <span class=n>fields</span><span class=o>.</span><span class=na>length</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>var7</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>var7</span> <span class=o>&lt;</span> <span class=n>var6</span><span class=o>;</span> <span class=o>++</span><span class=n>var7</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Field</span> <span class=n>field</span> <span class=o>=</span> <span class=n>var5</span><span class=o>[</span><span class=n>var7</span><span class=o>];</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=o>(</span><span class=n>ff</span> <span class=o>==</span> <span class=kc>null</span> <span class=o>||</span> <span class=n>ff</span><span class=o>.</span><span class=na>matches</span><span class=o>(</span><span class=n>field</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>fc</span><span class=o>.</span><span class=na>doWith</span><span class=o>(</span><span class=n>field</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>IllegalAccessException</span> <span class=n>var10</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>throw</span> <span class=k>new</span> <span class=n>IllegalStateException</span><span class=o>(</span><span class=s>&#34;Not allowed to access field &#39;&#34;</span> <span class=o>+</span> <span class=n>field</span><span class=o>.</span><span class=na>getName</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;&#39;: &#34;</span> <span class=o>+</span> <span class=n>var10</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>targetClass</span> <span class=o>=</span> <span class=n>targetClass</span><span class=o>.</span><span class=na>getSuperclass</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>while</span><span class=o>(</span><span class=n>targetClass</span> <span class=o>!=</span> <span class=kc>null</span> <span class=o>&amp;&amp;</span> <span class=n>targetClass</span> <span class=o>!=</span> <span class=n>Object</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span></code></pre></div><p>특히 fields들을 조회하는 method를 보면 <code>targetClass = targetClass.getSuperclass();</code> 부분이 있다! extend하는 경우는 생각하지 못했었는데.. 이러한 처리 부분이 있는 걸 보고 좀 쇼킹했다!</p><h2 id=내-생각>내 생각<a hidden class=anchor aria-hidden=true href=#내-생각>#</a></h2><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><p>정확히 정의된 Class를 입력 받는 것이 아닌, 추상화 상태의 Class를 통해 조작을 하니 넓은 범위를 커버 가능한 method를 작성할 수 있다는 게 큰 장점인 것 같다. 실제로 Spring이 구현될 수 있었던 핵심 spec 아닐까..?</p><h3 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h3><p>OOP의 원칙인 캡슐화를 부숴버린다!! 생각보다 심각한 문제라고 생각이 들긴 하는데 만약 해당 method가 정확하게 guide 된 것에 따라가지 않는다면 사용자는 확인하기 어려운 이슈가 발생할 수 있을 것 같다!</p><p>또한 연관 검색어로 항상 성능 이슈가 나온다! 그 원인은 Compiler의 최적화 단계를 거치지 않기 때문이라고 한다. 해서 무거운 logic이나 무분별하게 도입하는 거는 지양해야 할 것 같다.</p><p><a href=https://lob-dev.tistory.com/entry/Java%EC%9D%98-Reflection-API>https://lob-dev.tistory.com/entry/Java의-Reflection-API</a></p><h3 id=정리>정리<a hidden class=anchor aria-hidden=true href=#정리>#</a></h3><p>Relection은 내 눈에는 보이지 않지만 수많은 Lib 내에서 나의 개발을 유연하게 돕는 역할로 매우 많이 쓰이는 API 이다. 그 기능을 이용하여 실제로 개발을 해보니 정말로 강력한 기능이라는 느낌이 들었다. 항상 Java 개발을 하면서 “아 이런 부분은 field로 조작해서 할 수 있지 않을까?” 라고 생각해 왔던 것들을 프로젝트 내에서 실제로 구현해보고, 해당 방식을 통하여 기존의 source의 길이가 어마어마하게 줄어들고, 유지보수도 매우 쉬어지는 것을 경험했다.</p><p>단순히 내가 구현을 해보며 느낀 장점 뿐만 아니라 실제로 프로젝트에 사용되는 주요 FrameWork들의 구현 방법에 대하여 알게 되어 조금 더 FrameWork의 구조를 파악하고 또 debugging 할 수 있는 영역이 늘어난 점도 매우 좋은 것 같다. 더욱 넓은 시각을 통해서 단순히 낮은 soruce level이 아닌 구조 전체를 통해서 문제를 파악하는 능력이 큰 것 같다!</p><p>항상 생각하는 거지만, 그냥 편의를 누리는 것은 개발자에게 가장 치명적인 독인 것 같다.. 그냥 납득하지 말자!</p><p>참조:</p><p><a href=https://docs.oracle.com/javase/8/docs/technotes/guides/reflection/index.html>https://docs.oracle.com/javase/8/docs/technotes/guides/reflection/index.html</a></p><p><a href=https://lob-dev.tistory.com/entry/Java>https://lob-dev.tistory.com/entry/Java</a>의-Reflection-API</p><p><a href=https://gyrfalcon.tistory.com/entry/Java-Reflection>https://gyrfalcon.tistory.com/entry/Java-Reflection</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://HyoseungJeon.github.io/tags/java/>Java</a></li><li><a href=https://HyoseungJeon.github.io/tags/oop/>OOP</a></li></ul><nav class=paginav><a class=prev href=https://HyoseungJeon.github.io/posts/designpattern/behavioral-patterns/strategypattern/><span class=title>« Prev</span><br><span>Strategy Pattern</span></a>
<a class=next href=https://HyoseungJeon.github.io/posts/java/generic/><span class=title>Next »</span><br><span>Generic</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://HyoseungJeon.github.io/>HyoSeung IT blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>