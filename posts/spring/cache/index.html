<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Cache | HyoSeung IT blog</title><meta name=keywords content="Cache"><meta name=description content="💡 통계 데이터 산출을 위한 Batch Job 하나를 작업했다! 헌데 Batch 프로젝트 구조 상 Job에서 전역으로 사용할 수 있는 변수를 지정하기 어려운 상황이였다! 하여 작업을 어떻게 할지 고려해보던 중 다른 개발자에게 Cache를 사용해보라는 얘기를 들었다!! 엥 Cache를 쉽게 적용할 수 있는 방법이 있구나..? 하고 그 존재를 알게 되어 내용을 작성해보려고 한다~~😁😁 Spring Cache 정의 The Spring Framework provides support for transparently adding caching to an application. At its core, the abstraction applies caching to methods, thus reducing the number of executions based on the information available in the cache."><meta name=author content="HyoSeung Jeon"><link rel=canonical href=https://HyoseungJeon.github.io/posts/spring/cache/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://HyoseungJeon.github.io/profile.png><link rel=icon type=image/png sizes=16x16 href=https://HyoseungJeon.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://HyoseungJeon.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://HyoseungJeon.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://HyoseungJeon.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><script defer crossorigin=anonymous src=/js/pro.sidebar.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Cache"><meta property="og:description" content="💡 통계 데이터 산출을 위한 Batch Job 하나를 작업했다! 헌데 Batch 프로젝트 구조 상 Job에서 전역으로 사용할 수 있는 변수를 지정하기 어려운 상황이였다! 하여 작업을 어떻게 할지 고려해보던 중 다른 개발자에게 Cache를 사용해보라는 얘기를 들었다!! 엥 Cache를 쉽게 적용할 수 있는 방법이 있구나..? 하고 그 존재를 알게 되어 내용을 작성해보려고 한다~~😁😁 Spring Cache 정의 The Spring Framework provides support for transparently adding caching to an application. At its core, the abstraction applies caching to methods, thus reducing the number of executions based on the information available in the cache."><meta property="og:type" content="article"><meta property="og:url" content="https://HyoseungJeon.github.io/posts/spring/cache/"><meta property="og:image" content="https://HyoseungJeon.github.io/profile2.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-14T14:04:50+09:00"><meta property="article:modified_time" content="2024-03-14T14:04:50+09:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://HyoseungJeon.github.io/profile2.png"><meta name=twitter:title content="Cache"><meta name=twitter:description content="💡 통계 데이터 산출을 위한 Batch Job 하나를 작업했다! 헌데 Batch 프로젝트 구조 상 Job에서 전역으로 사용할 수 있는 변수를 지정하기 어려운 상황이였다! 하여 작업을 어떻게 할지 고려해보던 중 다른 개발자에게 Cache를 사용해보라는 얘기를 들었다!! 엥 Cache를 쉽게 적용할 수 있는 방법이 있구나..? 하고 그 존재를 알게 되어 내용을 작성해보려고 한다~~😁😁 Spring Cache 정의 The Spring Framework provides support for transparently adding caching to an application. At its core, the abstraction applies caching to methods, thus reducing the number of executions based on the information available in the cache."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://HyoseungJeon.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Spring","item":"https://HyoseungJeon.github.io/posts/spring/"},{"@type":"ListItem","position":3,"name":"Cache","item":"https://HyoseungJeon.github.io/posts/spring/cache/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Cache","name":"Cache","description":"💡 통계 데이터 산출을 위한 Batch Job 하나를 작업했다! 헌데 Batch 프로젝트 구조 상 Job에서 전역으로 사용할 수 있는 변수를 지정하기 어려운 상황이였다! 하여 작업을 어떻게 할지 고려해보던 중 다른 개발자에게 Cache를 사용해보라는 얘기를 들었다!! 엥 Cache를 쉽게 적용할 수 있는 방법이 있구나..? 하고 그 존재를 알게 되어 내용을 작성해보려고 한다~~😁😁 Spring Cache 정의 The Spring Framework provides support for transparently adding caching to an application. At its core, the abstraction applies caching to methods, thus reducing the number of executions based on the information available in the cache.","keywords":["Cache"],"articleBody":" 💡 통계 데이터 산출을 위한 Batch Job 하나를 작업했다! 헌데 Batch 프로젝트 구조 상 Job에서 전역으로 사용할 수 있는 변수를 지정하기 어려운 상황이였다! 하여 작업을 어떻게 할지 고려해보던 중 다른 개발자에게 Cache를 사용해보라는 얘기를 들었다!! 엥 Cache를 쉽게 적용할 수 있는 방법이 있구나..? 하고 그 존재를 알게 되어 내용을 작성해보려고 한다~~😁😁 Spring Cache 정의 The Spring Framework provides support for transparently adding caching to an application. At its core, the abstraction applies caching to methods, thus reducing the number of executions based on the information available in the cache. The caching logic is applied transparently, without any interference to the invoker. Spring Boot auto-configures the cache infrastructure as long as caching support is enabled via the @EnableCaching annotation. 출처 - https://docs.spring.io/spring-boot/docs/2.1.6.RELEASE/reference/html/boot-features-caching.html\nSpring Boot 에서는 간단하게 annotation으로 Cache 기능을 지원한다!! 그렇게 막 특별한 건 없다.. 자동으로 Cache 기능을 구현해준다는 점이 포인트이다!\n본 Posting에서는 Redis 사용 방식을 설명하진 않는다! 해당 내용은 다른 Posting에 작성할 예정이고, 해당 내용이 궁금하면 다른 Blog를 참고..!!🙄\n종류 Local Cache\n해당 Cache 처리를 위한 저장소를 현재 서버의 내부 저장소로 사용한다!\n단, 복수 인스턴스 환경, MSA 환경에서는 해당 데이터가 공유되지 않는다. 또한 각 Local 영역을 사용함으로 각 Cache 데이터가 다를 수 있다! 또한 서버 영역에 저장하는 만큼의 성능 저하 등의 Side Effect가 발생할 가능성이 있다.\n하지만 저장소로의 접근에 네트워크 호출이 적어 속도가 상대적으로 빠르다!\nGlobal Cache\n서버 외부에 별도의 Cache 서버를 구축해두는 방식이다! 서버 간의 데이터가 공유 가능하고, 일관성을 유지할 수 있다. 하지만 서버 단이 추가되는 만큼 네트워크 트래픽이 추가적으로 발생하게 된다.\n각 방법의 장단점이 명확함으로 프로젝트 환경을 고려하여 적절한 Caching 전략을 선택하면 된다!\n사용 방법 빌드 관리 도구를 통해 필요한 의존성을 추가해준다. (Redis 사용 시 추가 필요) Config 설정을 추가해준다. CacheManager를 정의, 추가 해준다. Cache 처리를 수행할 Service method에 Annotation을 추가해준다. (설정값 함께 정의) 자세한 사용방법은 타 블로그들에 잘 정리되어 있다.\n주의사항 Cache 유효시간\nCache를 사용할 시간을 해당 조회 데이터의 변경 주기를 확인하여 작성이 필요하다! 실시간 혹은 변경사항이 사용자에게 곧바로 반영되야 하는 데이터라면 사용을 지양하거나 Cache 삭제, 갱신 기능을 추가해야 됨을 인지해야한다.\n내부호출 금지\nSpring Cache도 Transaction과 같이 AOP 방식으로 동작한다! 때문에 Service 내에서 호출 시 동작하지 않는다.\nKey 값 설정\nkey 값을 미설정 시 해당 Service의 param값을 이용하여 자체적으로 Key를 생성한다. 하지만 Class 단위의 Param의 경우 상대적으로 Key 생성에 부하, 혹은 예상치 않은 Caching 값 Mapping이 일어날 수 있다. 함으로 사용자가 기본적으로 primary한 key값을 지정해 주는 것이 좋다.\n사용 예 작업하는 Batch Job의 내용은 1시간 단위로 각 원본 데이터를 조회한 후 집계하여 테이블에 저장하는 내용이였다! Batch 서버의 Job 구조는 read, process, write의 구조였다. read에서는 n개의 row를 읽고, process는 각 row 데이터를 단 건씩 처리, write는 chunk size만큼 process처리가 끝난 Data를 write 처리하는 구조였다! 헌데 read 단에서는 적재할 통계 데이터의 원본 형태를 읽어오고 있었고 2개의 read 문을 넣는 경우는 없는 case였다! 또한 각 집계 데이터들의 DB도 달라 한번에 조회하기도 어려운 상황이였다! (사실 이렇게 읽는 것 자체도 말이 안된다고 생각한다…) 하여 read 단에서는 기준 데이터를 조회, process단에서 통계 데이터를\n원래 의도하였던 작업 방식은 process 단에서 통계 데이터를 원본 데이터와 mapping하여 처리 후 write하는 방식이였는데, process에서 통계 데이터를 매번 조회하는 것이 불필요하다고 판단하여 따로 로직을 분리하려고 하였다. 헌데 Job이 Component로 정의되어 있어 따로 가변 전역 변수를 추가하는 것이 불안했다. 하여 차선책으로 전역변수로 추가한 후 write 단에서 통계 데이터를 조회한 후 마지막 단에서 해당 값을 초기화 해주는 방식으로 작업하였다.\n후에 위 방식이 불안정 하다고 판단되어.. 위 통계 데이터 조회 부분을 Caching 처리를 통해 내용을 수정하였다! 마음이 편안..😊\n추가적으로 Client Info를 통해 화면명을 조회하는 기능을 작업하였는데, 사실 해당 데이터는 사전에 정의 후 수정되는 일이 거의 없다고 판단하여 Cache를 추가하였다! 처음부터 Cache를 적용한지라 성능 향상이 얼마나 된지는 확인하지 못했지만, 불필요한 Db Connection을 굉장히 많이 줄였다!!\n결론 Spring에서 다해주네.. 사실 이게 끝이다!! 어지간한 기능들은 스프링에서 다 지원해주고, 정확한 Guide를 따라 작업만 한다면 사실상 의도했던 기능들이 다 정확히 동작한다.. 🤔 오히려 너무 할게 없어서 당황스럽기도 하다..! 사실 개발자는 Annotation 몇 줄에, 설정 값 정의만 하면 끝이다!! 물론 해당 설정 값을 정의하는 과정에서 내용 파악과 등등 작업이 필요하지만, 기술적인 구현 부분에서는 불필요한 과정이 다 필요가 없어진다..\n사실상 기능을 적용하는 능력 보다는 프로젝트의 상황과 성능, 현재 비즈니스가 요구하는 응답속도 등을 고려하여 적용할 부분을 찾고, 요구사항에 맞는 혹은 필요한 Cache Config를 정의하는 작업 등의 역량이 더 중요한 것 같다!! 내 서비스의 목적과 기능을 고려하여 작업하는 개발자가 되자!! ☺🤗\n출처 캐시를 통한 성능 최적화 33. Caching [Spring] Cache를 적용하여 응답속도 개선하기 Cache Abstraction :: Spring Framework\n","wordCount":"697","inLanguage":"en","datePublished":"2024-03-14T14:04:50+09:00","dateModified":"2024-03-14T14:04:50+09:00","author":{"@type":"Person","name":"HyoSeung Jeon"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://HyoseungJeon.github.io/posts/spring/cache/"},"publisher":{"@type":"Organization","name":"HyoSeung IT blog","logo":{"@type":"ImageObject","url":"https://HyoseungJeon.github.io/profile.png"}}}</script><link rel=stylesheet href=https://HyoseungJeon.github.io/scss/main.css></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://HyoseungJeon.github.io/ accesskey=h title="Home (Alt + H)"><img src=https://HyoseungJeon.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://HyoseungJeon.github.io/posts/ title=posts class=btn-12><span style=font-family:SUITE-Regular;font-size:19px>posts</span></a></li><li><a href=https://HyoseungJeon.github.io/tags/ title=tags class=btn-12><span style=font-family:SUITE-Regular;font-size:19px>tags</span></a></li><li><a href=https://HyoseungJeon.github.io/archives/ title=archives class=btn-12><span style=font-family:SUITE-Regular;font-size:19px>archives</span></a></li><li><a href=https://HyoseungJeon.github.io/search/ title="search (Alt + /)" class=btn-12 accesskey=/><span style=font-family:SUITE-Regular;font-size:19px>search</span></a></li></ul></nav></header><main class="main page"><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://HyoseungJeon.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://HyoseungJeon.github.io/posts/>Posts</a>&nbsp;»&nbsp;<a href=https://HyoseungJeon.github.io/posts/spring/>Spring</a></div><h1 class=post-title>Cache</h1><div class=post-meta><span title='2024-03-14 14:04:50 +0900 +0900'>March 14, 2024</span>&nbsp;·&nbsp;697 words&nbsp;·&nbsp;HyoSeung Jeon</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner style=padding-top:10px><ul><li><a href=#spring-cache aria-label="Spring Cache">Spring Cache</a><ul><li><a href=#%ec%a0%95%ec%9d%98 aria-label=정의>정의</a></li><li><a href=#%ec%a2%85%eb%a5%98 aria-label=종류>종류</a></li><li><a href=#%ec%82%ac%ec%9a%a9-%eb%b0%a9%eb%b2%95 aria-label="사용 방법">사용 방법</a></li><li><a href=#%ec%a3%bc%ec%9d%98%ec%82%ac%ed%95%ad aria-label=주의사항>주의사항</a></li></ul></li><li><a href=#%ec%82%ac%ec%9a%a9-%ec%98%88 aria-label="사용 예">사용 예</a></li><li><a href=#%ea%b2%b0%eb%a1%a0 aria-label=결론>결론</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?(document.getElementById("toc-container").classList.add("wide"),document.getElementById("menu-container").style.display=""):(document.getElementById("toc-container").classList.remove("wide"),document.getElementById("menu-container").style.display="none")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/remixicon@2.2.0/fonts/remixicon.css><link rel=stylesheet href=https://unpkg.com/css-pro-layout@1.1.0/dist/css/css-pro-layout.css><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&amp;display=swap"><script src=https://unpkg.com/@popperjs/core@2></script><div id=menu-container class="layout toc-container wide-r"><aside id=sidebar class="sidebar break-point-sm has-bg-image" style=width:100%;position:sticky;top:var(--gap)><div class=sidebar-layout><div class=sidebar-content><nav class="menu open-current-submenu"><ul><li class="menu-item sub-menu" name=API data-level=0><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>API
<span class=menu-title-suffix>(4)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class="menu-item page-menu" name=FCM data-level=1><a href=/posts/api/fcm/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>FCM</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name="Nice 본인인증" data-level=1><a href=/posts/api/nice%EB%B3%B8%EC%9D%B8%EC%9D%B8%EC%A6%9D/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Nice 본인인증</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name="Nice본인인증 이슈대응" data-level=1><a href=/posts/api/nice%EB%B3%B8%EC%9D%B8%EC%9D%B8%EC%A6%9D%EC%9D%B4%EC%8A%88%EB%8C%80%EC%9D%91/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Nice본인인증 이슈대응</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name=Nice본인인증이슈대응2 data-level=1><a href=/posts/api/nice%EB%B3%B8%EC%9D%B8%EC%9D%B8%EC%A6%9D%EC%9D%B4%EC%8A%88%EB%8C%80%EC%9D%912/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Nice본인인증이슈대응2</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu" name=Chrome data-level=0><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Chrome
<span class=menu-title-suffix>(1)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class="menu-item page-menu" name=Debug data-level=1><a href=/posts/chrome/debug/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Debug</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu" name="Design Pattern" data-level=0><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Design Pattern
<span class=menu-title-suffix>(3)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class="menu-item sub-menu" name="Behavioral Patterns" data-level=1><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Behavioral Patterns
<span class=menu-title-suffix>(1)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class="menu-item page-menu" name="Strategy Pattern" data-level=2><a href=/posts/designpattern/behavioralpatterns/strategypattern/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Strategy Pattern</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item page-menu" name="Creational Patterns" data-level=1><a href=/posts/designpattern/creationalpatterns/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Creational Patterns</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name="Structural Patterns" data-level=1><a href=/posts/designpattern/structuralpatterns/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Structural Patterns</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu" name=ETC data-level=0><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>ETC
<span class=menu-title-suffix>(4)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class="menu-item page-menu" name=LDAP data-level=1><a href=/posts/etc/ldap/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>LDAP</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name="MSA Id Auditing" data-level=1><a href=/posts/etc/msaidauditing/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>MSA Id Auditing</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name="MSA 환경 TraceId Logging" data-level=1><a href=/posts/etc/msa-%ED%99%98%EA%B2%BD-traceid-logging/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>MSA 환경 TraceId Logging</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name=OAuth data-level=1><a href=/posts/etc/oauth/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>OAuth</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu" name=HTML data-level=0><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>HTML
<span class=menu-title-suffix>(2)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class="menu-item page-menu" name="Page Reload Issue" data-level=1><a href=/posts/html/pagereloadissue/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Page Reload Issue</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name="Page Reload Issue 2" data-level=1><a href=/posts/html/pagereloadissue2/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Page Reload Issue 2</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu" name=Intellij data-level=0><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Intellij
<span class=menu-title-suffix>(2)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class="menu-item page-menu" name="Properties Auto Upper" data-level=1><a href=/posts/intellij/propertiesautoupper/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Properties Auto Upper</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name=Thymeleaf data-level=1><a href=/posts/intellij/thymeleaf/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Thymeleaf</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu" name=Java data-level=0><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Java
<span class=menu-title-suffix>(10)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class="menu-item page-menu" name="Blocking Queue" data-level=1><a href=/posts/java/blockingqueue/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Blocking Queue</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name=Cursor data-level=1><a href=/posts/java/cursor/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Cursor</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name=File data-level=1><a href=/posts/java/file/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>File</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name="Function Package" data-level=1><a href=/posts/java/function-package/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Function Package</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name=Future data-level=1><a href=/posts/java/future/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Future</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name=Generic data-level=1><a href=/posts/java/generic/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Generic</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name=Jasypt data-level=1><a href=/posts/java/jasypt/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Jasypt</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name=Reflection data-level=1><a href=/posts/java/reflection/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Reflection</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name=Synchronized data-level=1><a href=/posts/java/synchronized/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Synchronized</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name="Thread Local" data-level=1><a href=/posts/java/threadlocal/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Thread Local</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu" name="Java Script" data-level=0><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Java Script
<span class=menu-title-suffix>(2)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class="menu-item page-menu" name="Custom Validate" data-level=1><a href=/posts/javascript/customvalidate/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Custom Validate</span>
<span class=menu-suffix></span></a></li><li class="menu-item sub-menu" name=Date data-level=1><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Date
<span class=menu-title-suffix>(1)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class="menu-item page-menu" name=setDate data-level=2><a href=/posts/javascript/date/setdate/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>setDate</span>
<span class=menu-suffix></span></a></li></ul></div></li></ul></div></li><li class="menu-item sub-menu" name=JQuery data-level=0><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>JQuery
<span class=menu-title-suffix>(2)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class="menu-item page-menu" name="JQuery Validate" data-level=1><a href=/posts/jquery/validate/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>JQuery Validate</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name=ZTree data-level=1><a href=/posts/jquery/ztree/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>ZTree</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu" name=Spring data-level=0><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Spring
<span class=menu-title-suffix>(6)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class="menu-item page-menu" name=Async data-level=1><a href=/posts/spring/async/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Async</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name=Cache data-level=1><a href=/posts/spring/cache/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Cache</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name="Custom Validate Annotation" data-level=1><a href=/posts/spring/customvalidateannotation/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Custom Validate Annotation</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name=RequestContextHolder data-level=1><a href=/posts/spring/requestcontextholder/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>RequestContextHolder</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name=Scope data-level=1><a href=/posts/spring/scope/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Scope</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name="Spring Security" data-level=1><a href=/posts/spring/springsecurity/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Spring Security</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu" name=SQL data-level=0><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>SQL
<span class=menu-title-suffix>(1)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class="menu-item page-menu" name="With Recursive" data-level=1><a href=/posts/sql/withrecursive/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>With Recursive</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu" name=Window data-level=0><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>Window
<span class=menu-title-suffix>(1)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class="menu-item page-menu" name="Nud 메모리누수" data-level=1><a href=/posts/window/nud%EB%A9%94%EB%AA%A8%EB%A6%AC%EB%88%84%EC%88%98/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Nud 메모리누수</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu" name=독후감 data-level=0><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>독후감
<span class=menu-title-suffix>(2)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class="menu-item page-menu" name="Clean Architecture" data-level=1><a href=/posts/%EB%8F%85%ED%9B%84%EA%B0%90/cleanarchitecture/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>Clean Architecture</span>
<span class=menu-suffix></span></a></li><li class="menu-item page-menu" name="쏙쏙 들어오는 함수형 코딩" data-level=1><a href=/posts/%EB%8F%85%ED%9B%84%EA%B0%90/%ED%95%A8%EC%88%98%ED%98%95%EC%BD%94%EB%94%A9/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>쏙쏙 들어오는 함수형 코딩</span>
<span class=menu-suffix></span></a></li></ul></div></li><li class="menu-item sub-menu" name=일기장 data-level=0><a href=#><span class=menu-icon><i class=ri-book-line></i></span>
<span class=menu-title>일기장
<span class=menu-title-suffix>(1)</span></span>
<span class=menu-suffix></span></a><div class=sub-menu-list data-popper-placement=left><ul><li class="menu-item page-menu" name=23.07.18 data-level=1><a href=/posts/%EC%9D%BC%EA%B8%B0%EC%9E%A5/23-07-18/ class=page><span class=menu-icon><i class=ri-sticky-note-fill></i></span>
<span class=menu-title>23.07.18</span>
<span class=menu-suffix></span></a></li></ul></div></li><ul></nav></div></div><div class=sidebar-footer></div></aside></div><style scoped></style><link rel=stylesheet href=https://HyoseungJeon.github.io/scss/pro-sidebar.css><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition()},!1),window.addEventListener("resize",function(){checkTocPosition()},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("menu-container").style.display="":document.getElementById("menu-container").style.display="none"}</script><div class=post-content><hr><style>#callout{background:#f1f1ef;padding:1.5em 1.25em;border-radius:3px;display:flex;flex-direction:row;margin-bottom:20px;color:var(--hljs-bg)}#callout-inner{margin-left:1em;white-space:pre-line}@media(max-width:767px){#callout{padding:1.5em .75em 1.5em .6em}#callout-inner{margin-left:.5em}}</style><div id=callout><div>💡</div><div id=callout-inner>통계 데이터 산출을 위한 Batch Job 하나를 작업했다! 헌데 Batch 프로젝트 구조 상 Job에서 전역으로 사용할 수 있는 변수를 지정하기 어려운 상황이였다! 하여 작업을 어떻게 할지 고려해보던 중 다른 개발자에게 Cache를 사용해보라는 얘기를 들었다!! 엥 Cache를 쉽게 적용할 수 있는 방법이 있구나..? 하고 그 존재를 알게 되어 내용을 작성해보려고 한다~~😁😁</div></div><h2 id=spring-cache>Spring Cache<a hidden class=anchor aria-hidden=true href=#spring-cache>#</a></h2><h3 id=정의>정의<a hidden class=anchor aria-hidden=true href=#정의>#</a></h3><blockquote><p>The Spring Framework provides support for transparently adding caching to an application. At its core, the abstraction applies caching to methods, thus reducing the number of executions based on the information available in the cache. The caching logic is applied transparently, without any interference to the invoker. Spring Boot auto-configures the cache infrastructure as long as caching support is enabled via the <code>@EnableCaching</code> annotation.
출처 - <a href=https://docs.spring.io/spring-boot/docs/2.1.6.RELEASE/reference/html/boot-features-caching.html>https://docs.spring.io/spring-boot/docs/2.1.6.RELEASE/reference/html/boot-features-caching.html</a></p></blockquote><p>Spring Boot 에서는 간단하게 annotation으로 Cache 기능을 지원한다!! 그렇게 막 특별한 건 없다.. 자동으로 Cache 기능을 구현해준다는 점이 포인트이다!</p><p>본 Posting에서는 Redis 사용 방식을 설명하진 않는다! 해당 내용은 다른 Posting에 작성할 예정이고, 해당 내용이 궁금하면 다른 Blog를 참고..!!🙄</p><h3 id=종류>종류<a hidden class=anchor aria-hidden=true href=#종류>#</a></h3><ul><li><p>Local Cache</p><p>해당 Cache 처리를 위한 저장소를 현재 서버의 내부 저장소로 사용한다!</p><p>단, 복수 인스턴스 환경, MSA 환경에서는 해당 데이터가 공유되지 않는다. 또한 각 Local 영역을 사용함으로 각 Cache 데이터가 다를 수 있다! 또한 서버 영역에 저장하는 만큼의 성능 저하 등의 Side Effect가 발생할 가능성이 있다.</p><p>하지만 저장소로의 접근에 네트워크 호출이 적어 속도가 상대적으로 빠르다!</p></li><li><p>Global Cache</p><p>서버 외부에 별도의 Cache 서버를 구축해두는 방식이다! 서버 간의 데이터가 공유 가능하고, 일관성을 유지할 수 있다. 하지만 서버 단이 추가되는 만큼 네트워크 트래픽이 추가적으로 발생하게 된다.</p></li></ul><p>각 방법의 장단점이 명확함으로 프로젝트 환경을 고려하여 적절한 Caching 전략을 선택하면 된다!</p><h3 id=사용-방법>사용 방법<a hidden class=anchor aria-hidden=true href=#사용-방법>#</a></h3><ol><li>빌드 관리 도구를 통해 필요한 의존성을 추가해준다. (Redis 사용 시 추가 필요)</li><li>Config 설정을 추가해준다.</li><li>CacheManager를 정의, 추가 해준다.</li><li>Cache 처리를 수행할 Service method에 Annotation을 추가해준다. (설정값 함께 정의)</li></ol><p>자세한 사용방법은 타 블로그들에 잘 정리되어 있다.</p><h3 id=주의사항>주의사항<a hidden class=anchor aria-hidden=true href=#주의사항>#</a></h3><ul><li><p>Cache 유효시간</p><p>Cache를 사용할 시간을 해당 조회 데이터의 변경 주기를 확인하여 작성이 필요하다! 실시간 혹은 변경사항이 사용자에게 곧바로 반영되야 하는 데이터라면 사용을 지양하거나 Cache 삭제, 갱신 기능을 추가해야 됨을 인지해야한다.</p></li><li><p>내부호출 금지</p><p>Spring Cache도 Transaction과 같이 <strong>AOP 방식</strong>으로 동작한다! 때문에 Service 내에서 호출 시 동작하지 않는다.</p></li><li><p>Key 값 설정</p><p>key 값을 미설정 시 해당 Service의 param값을 이용하여 자체적으로 Key를 생성한다. 하지만 Class 단위의 Param의 경우 상대적으로 Key 생성에 부하, 혹은 예상치 않은 Caching 값 Mapping이 일어날 수 있다. 함으로 사용자가 기본적으로 primary한 key값을 지정해 주는 것이 좋다.</p></li></ul><h2 id=사용-예>사용 예<a hidden class=anchor aria-hidden=true href=#사용-예>#</a></h2><p>작업하는 Batch Job의 내용은 1시간 단위로 각 원본 데이터를 조회한 후 집계하여 테이블에 저장하는 내용이였다! Batch 서버의 Job 구조는 read, process, write의 구조였다. read에서는 n개의 row를 읽고, process는 각 row 데이터를 단 건씩 처리, write는 chunk size만큼 process처리가 끝난 Data를 write 처리하는 구조였다! 헌데 read 단에서는 적재할 통계 데이터의 원본 형태를 읽어오고 있었고 2개의 read 문을 넣는 경우는 없는 case였다! 또한 각 집계 데이터들의 DB도 달라 한번에 조회하기도 어려운 상황이였다! (사실 이렇게 읽는 것 자체도 말이 안된다고 생각한다…) 하여 read 단에서는 기준 데이터를 조회, process단에서 통계 데이터를</p><p>원래 의도하였던 작업 방식은 process 단에서 통계 데이터를 원본 데이터와 mapping하여 처리 후 write하는 방식이였는데, process에서 통계 데이터를 매번 조회하는 것이 불필요하다고 판단하여 따로 로직을 분리하려고 하였다. 헌데 Job이 Component로 정의되어 있어 따로 가변 전역 변수를 추가하는 것이 불안했다. 하여 차선책으로 전역변수로 추가한 후 write 단에서 통계 데이터를 조회한 후 마지막 단에서 해당 값을 초기화 해주는 방식으로 작업하였다.</p><p>후에 위 방식이 불안정 하다고 판단되어.. 위 통계 데이터 조회 부분을 Caching 처리를 통해 내용을 수정하였다! 마음이 편안..😊</p><p>추가적으로 Client Info를 통해 화면명을 조회하는 기능을 작업하였는데, 사실 해당 데이터는 사전에 정의 후 수정되는 일이 거의 없다고 판단하여 Cache를 추가하였다! 처음부터 Cache를 적용한지라 성능 향상이 얼마나 된지는 확인하지 못했지만, 불필요한 Db Connection을 굉장히 많이 줄였다!!</p><h2 id=결론>결론<a hidden class=anchor aria-hidden=true href=#결론>#</a></h2><p>Spring에서 다해주네.. 사실 이게 끝이다!! 어지간한 기능들은 스프링에서 다 지원해주고, 정확한 Guide를 따라 작업만 한다면 사실상 의도했던 기능들이 다 정확히 동작한다.. 🤔 오히려 너무 할게 없어서 당황스럽기도 하다..! 사실 개발자는 Annotation 몇 줄에, 설정 값 정의만 하면 끝이다!! 물론 해당 설정 값을 정의하는 과정에서 내용 파악과 등등 작업이 필요하지만, 기술적인 구현 부분에서는 불필요한 과정이 다 필요가 없어진다..</p><p>사실상 기능을 적용하는 능력 보다는 프로젝트의 상황과 성능, 현재 비즈니스가 요구하는 응답속도 등을 고려하여 적용할 부분을 찾고, 요구사항에 맞는 혹은 필요한 Cache Config를 정의하는 작업 등의 역량이 더 중요한 것 같다!! 내 서비스의 목적과 기능을 고려하여 작업하는 개발자가 되자!! ☺🤗</p><p>출처
<a href=https://velog.io/@flaehdan/DB-Cache>캐시를 통한 성능 최적화</a>
<a href=https://docs.spring.io/spring-boot/docs/2.1.6.RELEASE/reference/html/boot-features-caching.html>33. Caching</a>
<a href=https://1-7171771.tistory.com/138>[Spring] Cache를 적용하여 응답속도 개선하기</a>
<a href=https://docs.spring.io/spring-framework/reference/integration/cache.html>Cache Abstraction :: Spring Framework</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://HyoseungJeon.github.io/tags/cache/>Cache</a></li></ul><nav class=paginav><a class=prev href=https://HyoseungJeon.github.io/posts/etc/msaidauditing/><span class=title>« Prev</span><br><span>MSA Id Auditing</span></a>
<a class=next href=https://HyoseungJeon.github.io/posts/spring/scope/><span class=title>Next »</span><br><span>Scope</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://HyoseungJeon.github.io/>HyoSeung IT blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>